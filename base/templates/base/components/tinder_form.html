{# base/templates/components/tinder_form.html #}
{% load static i18n %}

<!-- Font (safe to include inside component; browsers dedupe) -->

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">

<!-- =========================
     APPLY DEMO — One continuous sequence:
     1) Upload resume ▶ 2) AI analyzes ▶ 3) Tinder deck ▶ 4) AI form
========================= -->

<section class="social-proof" id="social-proof">
  <div class="sp__inner">
    <header class="sp__head">
      <h2 class="sp__title">
        <span id="spTitle"
              data-default="{% trans 'Do like everyone else — apply with AI' %}"
              data-left="{% trans 'Swipe left to dismiss' %}"
              data-right="{% trans 'Swipe right to apply' %}">
          {% trans "Do like everyone else — apply with AI" %}
        </span>
      </h2>
      <p class="sp__sub">
        {% trans "Apply to hundreds of jobs in minutes" %}
      </p>
    </header>


<div class="demo-stage">
  <!-- (Optional) floating explainer -->
  <div class="demo-overlay" aria-live="polite">
    <span class="demo-overlay__text" role="status" aria-atomic="true"></span>
  </div>

  <!-- ===== STEP 1: Upload Resume (centered) ===== -->
  <div class="step step--resume" id="resumeStep" hidden>
    <div class="resume-step__inner">


      <div class="rs" id="resumeDemo" role="group" aria-describedby="rs-live">
        <!-- Centered Dropzone -->
        <div class="rs-dropzone" aria-label="{% trans 'Upload your resume' %}">
          <div class="rs-dropzone__icon" aria-hidden="true">⬆️</div>
          <div class="rs-dropzone__text">
            <strong>{% trans "Upload your resume" %}</strong>
            <span class="rs-dropzone__hint">{% trans "Drag & drop or click to browse" %}</span>
          </div>

          <!-- Progress -->
          <div class="rs-progress" aria-hidden="true">
            <div class="rs-progress__bar"></div>
            <span class="rs-progress__pct">0%</span>
          </div>

          <!-- Success -->
          <div class="rs-done" aria-hidden="true">
            <svg viewBox="0 0 52 52" class="rs-check">
              <circle cx="26" cy="26" r="24" class="ring"></circle>
              <path d="M16 27l7 7 13-13" class="mark"></path>
            </svg>
            <span>{% trans "Uploaded" %}</span>
          </div>
        </div>

        <!-- Draggable file card (starts left of center) -->
        <figure class="rs-file" aria-label="{% trans 'Resume file' %}">
          <div class="rs-file__tab"></div>
          <div class="rs-file__icon" aria-hidden="true">📄</div>
          <figcaption class="rs-file__name">Ava_Jensen_Resume.pdf</figcaption>
        </figure>

        <!-- Cursor -->
        <div class="rs-cursor" aria-hidden="true">
          <svg viewBox="0 0 24 24" class="rs-pointer">
            <path d="M4 3l13 7.5-6.2 1.9 3.2 6.7-2.2 1-3.2-6.7L6 16.9 4 3z" fill="#111"/>
          </svg>
        </div>

        <!-- Live announcements -->
        <p id="rs-live" class="sr-only" aria-live="polite">{% trans "First you upload your resume" %}</p>
      </div>
    </div>
  </div>

  <!-- ===== STEP 2: AI analyzes resume ===== -->
  <div class="step step--analysis" id="analysisStep" hidden>
    <div class="ra__inner">


      <div class="ra" id="raDemo" role="group" aria-describedby="ra-live">
        <!-- Progress / status -->
        <div class="ra-top">
          <div class="ra-progress" aria-hidden="true">
            <div class="ra-progress__bar"></div>
            <span class="ra-progress__pct">0%</span>
          </div>
          <span class="ra-status" id="ra-live" aria-live="polite">
            {% trans "Scanning document…" %}
          </span>
        </div>

        <!-- Stage: resume preview + extracted fields -->
        <div class="ra-stage">
          <!-- Resume -->
          <div class="ra-viewport" aria-label="{% trans 'Resume preview' %}">
            <article class="ra-doc" role="document" aria-label="{% trans 'Resume' %}">
              <header class="ra-doc__head">
                <h2 id="ra-name">Ava Jensen</h2>
                <p class="ra-doc__meta">
                  <span id="ra-email">ava.jensen@uni.dk</span> ·
                  <span id="ra-phone">+45 12 34 56 78</span> ·
                  <span id="ra-location">Copenhagen, DK</span>
                </p>
              </header>

              <section class="ra-sec">
                <h3>Experience</h3>
                <div id="ra-exp" class="ra-block">
                  <h4>Investment Banking Intern — Goldman Sachs</h4>
                  <p>Built DCFs and LBO models for live deals; prepared client-ready materials; supported due diligence and market comps.</p>
                  <ul>
                    <li>Modeled M&amp;A scenarios across 3 cases; presented takeaways to VP team.</li>
                    <li>Automated comp pulls in Excel; reduced prep time by 35%.</li>
                  </ul>
                </div>
              </section>

              <section class="ra-sec">
                <h3>Education</h3>
                <div id="ra-edu" class="ra-block">
                  <h4>Copenhagen Business School — BSc Finance</h4>
                  <p>Expected 2026 · GPA 3.8/4.0 · CBS Finance Club</p>
                </div>
              </section>

              <section class="ra-sec">
                <h3>Skills</h3>
                <p id="ra-skills" class="ra-inline">Excel, PowerPoint, Bloomberg, Python (pandas), Financial Modeling</p>
              </section>
            </article>
          </div>

          <!-- Extracted fields -->
          <aside class="ra-panel" aria-label="{% trans 'Extracted fields' %}">
            <h4 class="ra-panel__title">{% trans "Extracted fields" %}</h4>
            <ul class="ra-list"></ul>
          </aside>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== STEP 3A: Tinder cards ===== -->
  <div class="tinder-section" aria-label="{% trans 'Automatic swipe demo' %}" hidden>
    <div class="tinder-deck line" data-autoplay="true">
      <!-- Card 1 -->
      <article class="card card--yellow">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Deutsche Bank" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Global Markets Intern" %}</h4>
              <h3 class="card__company">Deutsche Bank</h3>
            </div>
          </header>

          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Frankfurt, Germany" %}</li>
            <li>💼 {% trans "Full-time Internship" %}</li>
            <li>🗓️ {% trans "Start: June 2026" %}</li>
          </ul>

          <p class="card__desc">
            {% trans "Support trading desks on macro research, pricing, and risk reporting while learning fixed income & FX products." %}
          </p>

          <div class="card__tags">
            <span class="tag">Excel</span><span class="tag">Bloomberg</span><span class="tag">Fixed Income</span><span class="tag">Python</span>
          </div>

          <footer class="card__footer">
            <span class="foot-item">⏳ {% trans "Deadline: Nov 30" %}</span>
          </footer>

          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 2 -->
      <article class="card card--blue">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="J.P. Morgan" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Investment Banking Intern" %}</h4>
              <h3 class="card__company">J.P. Morgan</h3>
            </div>
          </header>

          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "London, UK" %}</li>
            <li>💼 {% trans "Off-cycle Internship" %}</li>
            <li>🗓️ {% trans "Start: March 2026" %}</li>
          </ul>

          <p class="card__desc">
            {% trans "Work on live M&A, DCM and ECM deals; build valuation models and create client-ready presentations with senior guidance." %}
          </p>

          <div class="card__tags">
            <span class="tag">DCF</span><span class="tag">LBO</span><span class="tag">PowerPoint</span><span class="tag">Comps</span>
          </div>

          <footer class="card__footer">
            <span class="foot-item">⏳ {% trans "Deadline: Dec 10" %}</span>
          </footer>

          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 3 -->
      <article class="card card--pink">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="McKinsey & Company" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Business Analyst Intern" %}</h4>
              <h3 class="card__company">McKinsey &amp; Company</h3>
            </div>
          </header>

          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Copenhagen, DK" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: July 2026" %}</li>
          </ul>

          <p class="card__desc">
            {% trans "Analyze markets and customer data, craft insights, and present recommendations that drive measurable client impact." %}
          </p>

          <div class="card__tags">
            <span class="tag">SQL</span><span class="tag">Excel</span><span class="tag">Storytelling</span><span class="tag">Slides</span>
          </div>

          <footer class="card__footer">
            <span class="foot-item">⏳ {% trans "Deadline: Dec 20" %}</span>
          </footer>

          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 4 -->
      <article class="card card--yellow">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Spotify" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Data Analyst Intern" %}</h4>
              <h3 class="card__company">Spotify</h3>
            </div>
          </header>

          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Stockholm, SE" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: June 2026" %}</li>
          </ul>

          <p class="card__desc">
            {% trans "Help product teams experiment and measure features; build dashboards and discover user behavior patterns." %}
          </p>

          <div class="card__tags">
            <span class="tag">Python</span><span class="tag">Pandas</span><span class="tag">A/B Testing</span><span class="tag">SQL</span>
          </div>

          <footer class="card__footer">
            <span class="foot-item">⏳ {% trans "Deadline: Jan 5" %}</span>
          </footer>

          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 5 -->
      <article class="card card--blue">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Goldman Sachs" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Markets Spring Intern" %}</h4>
              <h3 class="card__company">Goldman Sachs</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Paris, FR" %}</li>
            <li>💼 {% trans "Spring Internship" %}</li>
            <li>🗓️ {% trans "Start: April 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Rotate across sales & trading, help prepare morning notes, and support trade execution." %}</p>
          <div class="card__tags"><span class="tag">Markets</span><span class="tag">Python</span><span class="tag">Options</span><span class="tag">Excel</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Dec 15" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 6 -->
      <article class="card card--pink">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="BCG" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Consulting Intern" %}</h4>
              <h3 class="card__company">BCG</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Berlin, DE" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: June 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Work with case teams, analyze data, and craft recommendations for digital and climate-related projects." %}</p>
          <div class="card__tags"><span class="tag">Excel</span><span class="tag">SQL</span><span class="tag">Slides</span><span class="tag">Research</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Jan 10" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 7 -->
      <article class="card card--yellow">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Amazon" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Product Analyst Intern" %}</h4>
              <h3 class="card__company">Amazon</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Luxembourg, LU" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: May 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Build dashboards, analyze customer journeys, and partner with product to prioritize experiments." %}</p>
          <div class="card__tags"><span class="tag">SQL</span><span class="tag">Tableau</span><span class="tag">A/B</span><span class="tag">Python</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Dec 22" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 8 -->
      <article class="card card--blue">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Citi" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Markets Summer Analyst" %}</h4>
              <h3 class="card__company">Citi</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "New York, US" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: June 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Shadow traders, contribute to desk analytics, and support client pitches across asset classes." %}</p>
          <div class="card__tags"><span class="tag">Fixed Income</span><span class="tag">S&T</span><span class="tag">VBA</span><span class="tag">Python</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Nov 28" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 9 -->
      <article class="card card--pink">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="EY" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Strategy & Transactions Intern" %}</h4>
              <h3 class="card__company">EY</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Oslo, NO" %}</li>
            <li>💼 {% trans "Off-cycle Internship" %}</li>
            <li>🗓️ {% trans "Start: February 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Support valuations, due diligence, and synergy modeling on live transactions." %}</p>
          <div class="card__tags"><span class="tag">Valuation</span><span class="tag">Modeling</span><span class="tag">PowerPoint</span><span class="tag">Excel</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Dec 05" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>

      <!-- Card 10 -->
      <article class="card card--yellow">
        <div class="card__body">
          <header class="card__header">
            <div class="card__logo-wrap">
              <img src="{% static 'images/deutsche-bank.png' %}" alt="Tesla" class="card__logo">
            </div>
            <div class="card__titles">
              <h4 class="card__role">{% trans "Data Science Intern" %}</h4>
              <h3 class="card__company">Tesla</h3>
            </div>
          </header>
          <ul class="card__meta-list" aria-label="{% trans 'Role details' %}">
            <li>📍 {% trans "Berlin, DE" %}</li>
            <li>💼 {% trans "Summer Internship" %}</li>
            <li>🗓️ {% trans "Start: June 2026" %}</li>
          </ul>
          <p class="card__desc">{% trans "Prototype ML features for manufacturing analytics and fleet telemetry dashboards." %}</p>
          <div class="card__tags"><span class="tag">Python</span><span class="tag">Pandas</span><span class="tag">ML</span><span class="tag">Dashboards</span></div>
          <footer class="card__footer"><span class="foot-item">⏳ {% trans "Deadline: Jan 12" %}</span></footer>
          <div class="card__actions" aria-label="{% trans 'Card actions' %}">
            <button type="button" class="action action--dismiss">{% trans "Dismiss" %}</button>
            <button type="button" class="action action--apply">{% trans "Apply" %}</button>
          </div>
        </div>
      </article>
    </div>
  </div>

  <!-- ===== STEP 3B: AI Autofill Form ===== -->
  <div class="ai-demo" hidden role="region" aria-label="{% trans 'AI auto-filling a job application' %}">
    <div class="ai-demo__window">
      <div class="ai-demo__chrome">
        <div class="ai-demo__dots"><span></span><span></span><span></span></div>
        <div class="ai-demo__title">
          {% trans "Job Application — Preview" %}
          <span id="ai-chip" class="ai-chip">{% trans "AI" %}</span>
        </div>
        <div class="ai-demo__progress">
          <div class="ai-demo__bar"></div><span class="ai-demo__pct">0%</span>
        </div>
      </div>

      <form class="ai-form" autocomplete="off" aria-describedby="ai-status">
        <div class="ai-field">
          <label for="ai-name">{% trans "Full name" %}</label>
          <input id="ai-name" type="text" placeholder="{% trans 'e.g., Ava Jensen' %}" inputmode="text" />
          <div class="ai-field__check" aria-hidden="true">✓</div>
        </div>

        <div class="ai-field">
          <label for="ai-email">{% trans "Email" %}</label>
          <input id="ai-email" type="email" placeholder="name@university.dk" />
          <div class="ai-field__check" aria-hidden="true">✓</div>
        </div>

        <div class="ai-field">
          <label for="ai-portfolio">{% trans "Portfolio / LinkedIn" %}</label>
          <input id="ai-portfolio" type="url" placeholder="https://…" />
          <div class="ai-field__check" aria-hidden="true">✓</div>
        </div>

        <div class="ai-field ai-field--file">
          <label for="ai-resume">{% trans "Resume" %}</label>
          <input id="ai-resume" type="file" accept=".pdf,.doc,.docx,.rtf" hidden>
          <div class="ai-file">
            <button type="button" class="ai-file__btn">{% trans "Attach resume" %}</button>
            <span class="ai-file__name" data-empty="{% trans 'No file selected' %}">{% trans "No file selected" %}</span>
          </div>
          <div class="ai-upload" aria-hidden="true"><div class="ai-upload__bar"></div></div>
          <div class="ai-field__check" aria-hidden="true">✓</div>
        </div>

        <div class="ai-field ai-field--textarea">
          <label for="ai-cover">{% trans "Short cover note" %}</label>
          <textarea id="ai-cover" rows="4" placeholder="{% trans 'A few sentences…' %}"></textarea>
          <div class="ai-field__check" aria-hidden="true">✓</div>
        </div>

        <div class="ai-consent">
          <input id="ai-consent" type="checkbox" />
          <label for="ai-consent">{% trans "I consent to submit this application." %}</label>
        </div>

        <div class="ai-actions">
          <button type="button" class="btn btn--primary ai-submit" disabled>{% trans "Apply now" %}</button>
        </div>

        <p id="ai-status" class="ai-status" aria-live="polite">{% trans "AI is preparing your application…" %}</p>
      </form>
    </div>
  </div>
</div><!-- /.demo-stage -->


  </div>
</section>

<style>
/* Always hide [hidden] robustly (prevents framework CSS overrides) */
[hidden]{display:none !important;}

/* ===== Base tokens (scoped-friendly) ===== */
:root{
  --font:'Manrope',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  --brand:#FF2F5A; --accent:#3B82F6; --ok:#10B981;
  --text:#0f172a; --muted:#667085; --line:#e7edf5;
  --container-max: 1480px;
  --card-w: clamp(360px, 30vw, 440px);
  --card-h: 600px;
  --card-pad: 22px;           /* tighter + cleaner */
  --action-gap: 12px;
}

/* ===== Section chrome / background ===== */
.social-proof{
  position:relative; isolation:isolate;
  padding: clamp(56px,8vw,110px) 0 clamp(40px,6vw,80px);
  background: linear-gradient(180deg,#fff 0%,#fbfcff 55%,#f6f8fc 100%);
  border-top:1px solid #eef2f7;
}
.sp__inner{ max-width: var(--container-max); margin:0 auto; padding:0 16px; display:flex; flex-direction:column; align-items:center; position:relative; }
.sp__head{ text-align:center; margin-bottom:22px; }
.sp__title{ margin:0; font: 900 clamp(22px,3vw,34px)/1 var(--font); color:#101828; letter-spacing:-.3px; }
.sp__sub{ margin:.5rem 0 0; color:var(--muted); font: 500 clamp(14px,1.6vw,16px)/1.5 var(--font); }

/* subtle grid + glows */
.social-proof::before,
.social-proof::after{ content:""; position:absolute; inset:0; pointer-events:none; z-index:-1; }
.social-proof::before{
  background-image:
    linear-gradient(to right, #e9edf5 1px, transparent 1px),
    linear-gradient(to bottom, #e9edf5 1px, transparent 1px);
  background-size:64px 64px,64px 64px; opacity:.35;
  mask-image: radial-gradient(130% 120% at 50% 10%, #000 55%, transparent 100%);
}
.social-proof::after{
  background-image:
    linear-gradient(to right, #eef2f7 1px, transparent 1px),
    linear-gradient(to bottom, #eef2f7 1px, transparent 1px);
  background-size:16px 16px,16px 16px; opacity:.12;
  mask-image: radial-gradient(140% 120% at 50% 0%, #000 40%, transparent 100%);
}

/* ===== Demo stage ===== */
.demo-stage{ position:relative; width:100%; min-height: var(--card-h); }
.demo-overlay{
  position:absolute; z-index:5; pointer-events:none; color:#667085; font: 700 14px/1.35 var(--font); max-width:260px;
}
.demo-overlay__text{ display:block; opacity:0; transform:translateY(-4px); transition:.35s; }
.demo-overlay__text.is-visible{ opacity:1; transform:none; }
.demo-overlay.is-deck-right{ top:50%; left:50%; margin-left: calc(var(--card-w)/2 + 22px); transform: translateY(-50%); text-align:left; }
.demo-overlay.is-form{ left:50%; top: calc(50% - var(--card-h)/2 - 28px); transform: translateX(-50%); width:100%; text-align:center; }

/* ===== Generic step container (centered overlay) ===== */
.step{
  position:absolute; inset:0; display:grid; place-items:center; z-index:10;
}
.step > *{ width:min(100%, 980px); }

/* ===== Tinder cards (base) ===== */
.tinder-section{ margin:0; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); z-index:10; }
.tinder-deck{ position:relative; width: var(--card-w); min-height: var(--card-h); margin:0 auto; perspective:1200px; }

/* Card visual refresh */
.card{
  width:var(--card-w); height:var(--card-h);
  background:#ffffff; border:1px solid #e8eef6;
  border-radius:20px;
  box-shadow: 0 18px 40px rgba(2,8,23,.10);
  overflow: hidden;
}
.card__body{ height:100%; padding:var(--card-pad); display:flex; flex-direction:column; gap:14px; }
.card__header{ display:flex; align-items:center; gap:14px; }
.card__logo-wrap{
  width:54px; height:54px; border-radius:12px; background:#f3f7ff; display:grid; place-items:center; border:1px solid #e6eefc;
}
.card__logo{ width:38px; height:38px; object-fit:contain; filter:saturate(1.05); }
.card__titles{ display:flex; flex-direction:column; }
.card__role{ margin:0; font:800 18px/1.25 var(--font); color:#0f172a; letter-spacing:.1px; }
.card__company{ margin:2px 0 0; font:800 16px/1.2 var(--font); color:#344053; }

.card__meta-list{
  display:flex; flex-wrap:wrap; gap:10px 14px; margin:0; padding:0; list-style:none;
  font:700 12px/1 var(--font); color:#475467;
}
.card__meta-list li{ background:#f6f9ff; border:1px solid #e7eef7; color:#415b86;
  padding:8px 10px; border-radius:999px; }

.card__desc{
  margin:0; color:#344054; font:600 14px/1.5 var(--font);
  background:#fbfdff; border:1px solid #eef3fa; border-radius:12px; padding:12px 14px;
}

.card__tags{ display:flex; flex-wrap:wrap; gap:8px; }
.tag{
  font:800 11.5px/1 var(--font); color:#0f4aad; background:#eef5ff; border:1px solid #dbe8ff;
  padding:8px 10px; border-radius:999px;
}
.card__footer{ display:flex; justify-content:flex-end; margin-top:auto; }
.foot-item{ font:800 12px/1 var(--font); color:#475467; background:#f6fff9; border:1px solid #def7eb; padding:8px 10px; border-radius:999px; }

.card--pink .card__logo-wrap{ background:#fff5f7; border-color:#ffe4ea; }
.card--blue .card__logo-wrap{ background:#f3f7ff; border-color:#e6eefc; }
.card--yellow .card__logo-wrap{ background:#fffbea; border-color:#fde68a; }

/* ===== Linear row layout (expanded neighbors; slower transitions) ===== */
.tinder-deck.line{
  --gap1: 260px;
  --gap2: 440px;
  --gap3: 620px;
  --gap4: 800px;
  --gap5: 980px;
  --deck-dur: 900ms; /* slow down deck movement */
}
@media (max-width: 1200px){
  .tinder-deck.line{ --gap1: 240px; --gap2: 400px; --gap3: 560px; --gap4: 720px; --gap5: 880px; }
}
@media (max-width: 900px){
  .tinder-deck.line{ --gap1: 200px; --gap2: 340px; --gap3: 480px; --gap4: 620px; --gap5: 760px; }
}
@media (max-width: 640px){
  .tinder-deck.line{ --gap1: 160px; --gap2: 280px; --gap3: 400px; --gap4: 520px; --gap5: 640px; }
}

.tinder-deck.line .card{
  position:absolute; top:0; left:50%;
  transform: translateX(-50%) translateY(var(--ty,0)) scale(.86);
  opacity:0; pointer-events:none;
  /* no blur, slightly darker look for non-active cards */
  filter: brightness(0.9) saturate(0.95);
  transition:
    transform var(--deck-dur) cubic-bezier(.22,.61,.36,1),
    opacity .45s ease,
    filter .45s ease,
    box-shadow .45s ease, outline-color .45s ease;
}

/* Center + two neighbors only (exactly 3 visible) */
.tinder-deck.line .card.is-center{
  transform: translateX(-50%) translateY(var(--ty,0)) scale(1);
  opacity:1; pointer-events:auto; z-index:10;
  filter: brightness(1) saturate(1);
}
.tinder-deck.line .card.is-left1,
.tinder-deck.line .card.is-right1{
  transform: translateX(calc(-50% + var(--shift,0))) translateY(0) scale(.94);
  opacity:.98; z-index:9;
  filter: brightness(0.96) saturate(0.95);
}
.tinder-deck.line .card.is-left1{  --shift: calc(-1 * var(--gap1)); }
.tinder-deck.line .card.is-right1{ --shift: var(--gap1); }

/* (Any positions beyond left1/right1 are hidden to guarantee only 3 visible) */
.tinder-deck.line .card.is-left2,
.tinder-deck.line .card.is-left3,
.tinder-deck.line .card.is-left4,
.tinder-deck.line .card.is-left5,
.tinder-deck.line .card.is-right2,
.tinder-deck.line .card.is-right3,
.tinder-deck.line .card.is-right4,
.tinder-deck.line .card.is-right5{ opacity:0 !important; visibility:hidden !important; pointer-events:none !important; }

/* applied state (after simulated click) — subtle rise feedback */
.tinder-deck.line .card.is-center.is-applied{ --ty: 0px; }
.tinder-deck.line .card.is-applied{
  box-shadow: 0 22px 60px rgba(16,185,129,.18);
  outline: 2px solid rgba(16,185,129,.5);
}
.tinder-deck.line .card.is-applied .action--apply{
  border-color:#BBF7D0; color:#059669;
}
.tinder-deck.line .card.is-applied::after{
  content:"{% trans 'Applied' %} ✓";
  position:absolute; top:12px; right:12px;
  font:800 11px/1 var(--font); color:#065f46;
  background:#ecfdf5; border:1px solid #bbf7d0; border-radius:999px; padding:6px 8px;
}

/* Actions */
.card__actions{ display:flex; gap:var(--action-gap); justify-content:center; margin-top:8px; padding-bottom:6px; }
.action{ height:44px; min-width:116px; padding:0 16px; border-radius:12px; background:#fff; border:1.5px solid #e5e7eb; box-shadow:0 2px 6px rgba(0,0,0,.06); font:800 14px/1 var(--font); color:#111; transition:.15s; }
.action.is-pressed{ transform:scale(.96); box-shadow: inset 0 2px 0 rgba(0,0,0,.02), 0 1px 2px rgba(0,0,0,.04); }
.action--dismiss{ color:#EF4444; border-color:#FECACA; }
.action--apply{ color:#10B981; border-color:#A7F3D0; }

/* ===== AI form ===== */
.ai-demo{ --ai-w:760px; --ai-pad:18px; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); z-index:1; }
@media (max-width:900px){ .ai-demo{ --ai-w:520px; } }
@media (max-width:600px){ .ai-demo{ --ai-w:100%; left:0; transform:none; } }
.ai-demo__window{ width:100%; max-width:var(--ai-w); border:1px solid #e5e7eb; border-radius:16px; background:#fff; box-shadow:0 18px 40px rgba(0,0,0,.12); overflow:hidden; transition: opacity .35s ease, transform .35s ease; }
.ai-demo__chrome{ display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:8px; padding:8px 10px; background:linear-gradient(180deg,#f8fafc 0%, #eef2f7 100%); border-bottom:1px solid #e5e7eb; }
.ai-demo__dots span{ display:inline-block; width:10px; height:10px; border-radius:50%; margin-right:6px; background:#ff5f56; }
.ai-demo__dots span:nth-child(2){ background:#ffbd2e; } .ai-demo__dots span:nth-child(3){ background:#27c93f; }
.ai-demo__title{ font:700 14px/1 var(--font); color:#111; display:flex; align-items:center; gap:8px; }
.ai-demo__progress{ display:flex; align-items:center; gap:8px; }
.ai-demo__bar{ --pct:0%; width:96px; height:6px; border-radius:999px; background:#e5e7eb; position:relative; overflow:hidden; }
.ai-demo__bar::after{ content:""; position:absolute; inset:0 auto 0 0; width:var(--pct); background:linear-gradient(90deg,var(--ok),var(--accent)); transition:width .25s ease; }
.ai-demo__pct{ font:500 11px/1 var(--font); color:#374151; min-width:32px; text-align:right; }
.ai-form{ padding:14px var(--ai-pad) 18px; display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:14px 16px; font-family:var(--font); }
.ai-field{ position:relative; display:grid; grid-template-columns:1fr 28px; grid-template-rows:auto auto; gap:6px 8px; }
.ai-field label{ grid-column:1/-1; font:600 12px/1 var(--font); color:#6b7280; }
.ai-field input,.ai-field textarea{ grid-column:1; width:100%; padding:12px; font: 500 14px/1.35 var(--font); border-radius:12px; border:1px solid #e5e7eb; outline:none; transition:.2s; }
.ai-field--textarea{ grid-column:1/-1; }
.ai-field--textarea textarea{ min-height:140px; resize:vertical; padding:16px 16px 20px 14px; }
.ai-field.is-active input,.ai-field.is-active textarea{ border-color: rgba(59,130,246,.6); box-shadow: 0 0 0 3px rgba(59,130,246,.15); }
.ai-field.is-done input,.ai-field.is-done textarea{ border-color: rgba(16,185,129,.6); box-shadow: 0 0 0 3px rgba(16,185,129,.12); background:#f7fffb; }
.ai-field__check{ grid-column:2; width:22px; height:22px; border-radius:50%; background:var(--ok); color:#fff; display:grid; place-items:center; font-weight:700; transform:scale(.6); opacity:0; transition:.18s; }
.ai-field.is-done .ai-field__check{ transform:scale(1); opacity:1; }
.ai-file{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.ai-file__btn{ height:36px; padding:0 14px; border-radius:10px; background:#fff; border:1.5px solid #e5e7eb; color:#111; font:700 13px/1 var(--font); box-shadow:0 1px 3px rgba(0,0,0,.08); transition:.15s; }
.ai-file__btn.is-pressed{ transform:scale(.97); background:#ECFDF5; border-color:#A7F3D0; color:#059669; }
.ai-file__name{ flex:1; text-align:right; font: 500 13px/1 var(--font); color:#6b7280; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ai-upload{ --up:0%; height:6px; border-radius:999px; background:#eef2f7; overflow:hidden; margin-top:8px; opacity:0; transition:.2s; }
.ai-upload.is-visible{ opacity:1; }
.ai-upload__bar{ width:var(--up); height:100%; background:linear-gradient(90deg,var(--ok),var(--accent)); transition:width .08s linear; }
.ai-consent{ grid-column:1/-1; display:flex; gap:10px; align-items:flex-start; margin:6px 0 10px; font:500 13px/1.4 var(--font); color:#374151; }
.ai-actions{ grid-column:1/-1; display:flex; gap:10px; flex-wrap:wrap; }
.btn{ display:inline-flex; align-items:center; justify-content:center; height:48px; padding:0 18px; border-radius:12px; font:700 16px/1 var(--font); border:1px solid transparent; text-decoration:none; }
.btn--primary{ background:var(--brand); color:#fff; box-shadow:0 4px 12px rgba(0,0,0,.08); }
.ai-status{ grid-column:1/-1; margin-top:12px; font: 600 12px/1.4 var(--font); color:#475467; }
.ai-status::before{ content:""; display:inline-block; width:6px; height:6px; border-radius:50%; background:#22c55e; margin-right:8px; box-shadow:0 0 0 0 rgba(34,197,94,.7); animation:pulse 1.6s infinite; }
@keyframes pulse{ 70%{ box-shadow:0 0 0 8px rgba(34,197,94,0) } }
.ai-demo__window.is-fading{ opacity:0; transform: translateY(8px) scale(.98); }
.ai-success{ position:absolute; inset:0; display:grid; place-items:center; background: rgba(255,255,255,.55); backdrop-filter:blur(4px); opacity:0; visibility:hidden; pointer-events:none; transition:.25s; border-radius:16px; }
.ai-success.is-visible{ opacity:1; visibility:visible; pointer-events:auto; }
.ai-success__card{ background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:24px 28px; width:min(92%,380px); text-align:center; box-shadow:0 12px 30px rgba(0,0,0,.14); }
.ai-success__icon svg{ width:56px; height:56px; }
.ai-success__icon .ring{ stroke:#A7F3D0; stroke-width:5; fill:none; opacity:.9; }
.ai-success__icon .mark{ stroke:#10B981; stroke-width:5; fill:none; stroke-linecap:round; stroke-linejoin:round; stroke-dasharray:60; stroke-dashoffset:60; animation: aiCheck .6s ease forwards .15s; }
@keyframes aiCheck{ to{ stroke-dashoffset:0; } }
.ai-demo__window.is-success{ border-color: rgba(16,185,129,.6); box-shadow: 0 0 0 3px rgba(16,185,129,.18), 0 18px 40px rgba(0,0,0,.12); }
.ai-form.is-success input,.ai-form.is-success textarea{ border-color: rgba(16,185,129,.7); background:#F0FDF4; }

/* ===== Upload resume (inside step) ===== */
.resume-step__inner{ width:min(980px,96vw); }
.resume-step__title{
  margin:0 0 18px;
  text-align:center;
  font:900 clamp(20px,2.6vw,28px)/1.15 var(--font,'Manrope',system-ui);
  color:#101828;
}
.rs {
  --box: #ffffff;
  --line: #e7edf5;
  --ink: #0f172a;
  --muted: #667085;
  --ok: #10B981;
  --accent: #3B82F6;
  position: relative;
  height: 380px;
  overflow: visible;
  max-width: 920px;
  margin: 0 auto;
  background: transparent; border: none; box-shadow: none;
}
@media (max-width:720px){ .rs{ height: 340px; } }
.rs-dropzone{
  position:absolute; left:50%; top:50%; transform: translate(-50%,-50%);
  width: min(520px, 88%); min-width:300px; background: var(--box);
  border: 2px dashed #cfe0ff; border-radius: 16px; padding: 20px;
  display:flex; align-items:center; gap:14px; box-shadow: 0 8px 24px rgba(2,8,23,.05);
}
.rs-dropzone.is-over{ border-color:#93c5fd; background:#f8fbff; }
.rs-dropzone__icon{ width:42px; height:42px; display:grid; place-items:center; font-size:22px; background:#eef6ff; color:#1d4ed8; border-radius:12px; }
.rs-dropzone__text{ display:flex; flex-direction:column; gap:4px; color:#0f172a; font-family:var(--font); }
.rs-dropzone__text strong{ font-weight:800; letter-spacing:.1px; }
.rs-dropzone__hint{ color:#667085; font-weight:600; font-size:12px; }

.rs-progress{ display:flex; align-items:center; gap:10px; margin-left:auto; opacity:0; transform: translateY(6px); transition:.25s ease; }
.rs-progress.is-visible{ opacity:1; transform:none; }
.rs-progress__bar{ --pct:0%; width:140px; height:8px; background:#eef2f7; border-radius:999px; position:relative; overflow:hidden; }
.rs-progress__bar::after{ content:""; position:absolute; inset:0 auto 0 0; width:var(--pct); background:linear-gradient(90deg,var(--ok),var(--accent)); transition: width .08s linear; }
.rs-progress__pct{ font:700 12px/1 var(--font); color:#475467; min-width:32px; text-align:right; }

.rs-done{ display:flex; align-items:center; gap:8px; margin-left:auto; opacity:0; transform:translateY(6px); transition:.25s ease; }
.rs-done.is-visible{ opacity:1; transform:none; }
.rs-check{ width:22px; height:22px; }
.rs-check .ring{ fill:none; stroke:#A7F3D0; stroke-width:4; opacity:.9 }
.rs-check .mark{ fill:none; stroke:#10B981; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-dasharray:60; stroke-dashoffset:60; }
.rs-done.is-visible .mark{ animation: rsCheck .6s ease forwards .1s; }
@keyframes rsCheck{ to { stroke-dashoffset:0; } }

/* Resume file (start far left) */
.rs-file{
  position: absolute; top:50%; left: calc(50% - 600px); transform: translateY(-50%);
  width: 240px; height: 140px; background:#fff; border:1px solid var(--line); border-radius:14px;
  box-shadow: 0 10px 26px rgba(2,8,23,.08);
  display:flex; flex-direction:column; justify-content:center; align-items:center; gap:10px;
}
.rs-file__tab{ width:56px; height:8px; background:#f2f4f7; border-radius:999px; }
.rs-file__icon{ font-size:26px; }
.rs-file__name{ font:800 12px/1.2 var(--font); color:#111827; padding:0 12px; text-align:center; }
.rs-file.is-grabbed{ transform: translate(0, -50%) scale(1.03); box-shadow: 0 12px 30px rgba(2,8,23,.12); }

.rs-cursor{ position:absolute; width:24px; height:24px; transform: translate3d(0,0,0); }
.rs-pointer{ width:100%; height:100%; filter: drop-shadow(0 2px 2px rgba(0,0,0,.25)); }
.sr-only{ position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

/* ===== AI Analysis styles (inside step) ===== */
.ra__inner{ width:min(1100px,96vw); }
.ra__title{ margin:0 0 18px; text-align:center; font:900 clamp(20px,2.6vw,28px)/1.15 var(--font,'Manrope',system-ui); color:#101828; }
.ra{ --hl-bg:#ECFDF5; --hl-edge:#BBF7D0; --hl-glow:rgba(16,185,129,.18);
     border:1px solid var(--line); border-radius:16px; background:#fff; box-shadow:0 10px 30px rgba(2,8,23,.06); }
.ra-top{ display:flex; align-items:center; gap:14px; padding:12px 14px; border-bottom:1px solid #eef2f7; }
.ra-status{ margin-left:auto; font:700 12px/1 var(--font); color:#475467; }
.ra-progress{ display:flex; align-items:center; gap:10px; }
.ra-progress__bar{ --pct:0%; width:220px; height:8px; background:#eef2f7; border-radius:999px; position:relative; overflow:hidden; }
.ra-progress__bar::after{ content:""; position:absolute; inset:0 auto 0 0; width:var(--pct); background:linear-gradient(90deg,var(--ok),var(--accent)); transition:width .15s linear; }
.ra-progress__pct{ font:800 12px/1 var(--font); color:#475467; min-width:32px; text-align:right; }
.ra-stage{ display:grid; grid-template-columns:1fr minmax(280px, 340px); gap:18px; padding:16px; }
@media (max-width:900px){ .ra-stage{ grid-template-columns:1fr; } }
.ra-viewport{ position: relative; height: 520px; border:1px dashed #cfe0ff; border-radius:14px; background: linear-gradient(180deg, #f9fbff, #fff 60%); overflow:hidden; display:flex; align-items:center; justify-content:center; }
@media (max-width:900px){ .ra-viewport{ height:460px; } }

.ra-doc{ width:min(720px,94%); margin:14px auto; background:#fff; border:1px solid #e7eef7; border-radius:12px; padding:22px 26px; color:#0f172a; box-shadow:0 8px 24px rgba(2,8,23,.05); min-height: calc(100% - 74px); display:flex; flex-direction:column; }
.ra-doc::after{ content:""; flex:1 1 auto; }
.ra-doc__head h2{ margin:0 0 4px; font:900 26px/1.15 var(--font); }
.ra-doc__meta{ margin:0; color:#64748b; font:600 13px/1.4 var(--font); }
.ra-sec{ margin-top:18px; }
.ra-sec h3{ margin:0 0 8px; font:800 14px/1 var(--font); letter-spacing:.3px; color:#111827; text-transform:uppercase; }
.ra-block h4{ margin:0 0 6px; font:800 15px/1.2 var(--font); }
.ra-doc p,.ra-doc li,.ra-inline{ font:500 13.5px/1.5 var(--font); color:#0f172a; }
.ra-doc ul{ margin:8px 0 0 18px; }

.ra-focus{ position:relative; z-index:0; }
.ra-focus::before{
  content:""; position:absolute; inset:-3px -6px; background: var(--hl-bg); border:1.5px solid var(--hl-edge);
  border-radius:10px; box-shadow: 0 6px 18px var(--hl-glow) inset, 0 8px 20px rgba(2,8,23,.06); z-index:-1; opacity:0; transform: translateY(2px); transition: opacity .18s ease, transform .18s ease, box-shadow .18s ease;
}
@keyframes raSweepBg{ from{ box-shadow: 0 6px 18px var(--hl-glow) inset, 0 8px 20px rgba(2,8,23,.06);} to{ box-shadow: 0 10px 26px var(--hl-glow) inset, 0 10px 24px rgba(2,8,23,.08);} }
.ra-focus.is-on::before{ opacity:1; transform:none; animation: raSweepBg .9s ease; }
.ra-focus.is-inline{ display:inline-block; border-radius:6px; }

/* Extracted panel */
.ra-panel{ border:1px dashed #e5eaf3; border-radius:12px; background:#fafcff; padding:12px; }
.ra-panel__title{ margin:0 0 8px; font:900 13px/1 var(--font); color:#0f172a; text-transform:uppercase; letter-spacing:.35px; }
.ra-list{ list-style:none; margin:0; padding:0; display:grid; gap:8px; }
.ra-item{ display:grid; grid-template-columns:92px 1fr auto; align-items:center; gap:8px; padding:8px 10px; background:#fff; border:1px solid #eef2f7; border-radius:10px; opacity:0; transform: translateY(6px); transition:.25s ease; }
.ra-item.is-in{ opacity:1; transform:none; }
.ra-k{ font:800 11.5px/1 var(--font); color:#64748b; text-transform:uppercase; letter-spacing:.3px; }
.ra-v{ font:700 12.5px/1.2 var(--font); color:#111827; }
.ra-ok{ color:#10B981; font:900 12px/1 var(--font); }

/* Reduced motion tweaks */
@media (prefers-reduced-motion: reduce){
  .rs-cursor{ display:none; }
  .rs,.ra-item,.ra-progress__bar::after{ transition:none !important; }
  .ra-focus.is-on::before{ animation:none !important; }
  .ai-demo__window{ transition:none !important; }
}
@media (max-width:1024px){
  .demo-overlay{ top:auto !important; bottom:-18px; left:50% !important; right:auto !important; margin:0 !important; transform: translateX(-50%) !important; text-align:center; max-width:90vw; }
}
@media (max-width:640px){
  :root{ --card-w: 332px; --card-h: 520px; }
  .demo-stage{ border-radius:18px; }
}
@media (max-width:600px){
  .demo-overlay{ display:none; }
}
</style>

<script>
/* =========================
   STEP 3A — Tinder line deck (exposes window.TinderDemo)
   ➜ Modified to ONLY show 3 cards at any time:
     active center + 1 neighbor left + 1 neighbor right
========================= */
(() => {
  const ready = (fn) => (document.readyState === 'loading'
    ? document.addEventListener('DOMContentLoaded', fn, { once:true })
    : fn());

  ready(() => {
    const deck = document.querySelector('.tinder-deck.line');
    if (!deck) return;

    const section = document.querySelector('.tinder-section');
    const cards = Array.from(deck.querySelectorAll('.card'));
    const overlay = document.querySelector('.demo-overlay');
    const overlayTextEl = document.querySelector('.demo-overlay__text');
    const spTitle = document.getElementById('spTitle');

    const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const pause = (ms) => new Promise(r => setTimeout(r, ms));

    let idx = 0;
    const N = cards.length;
    const MAX_NEI = 1; // <<< only one neighbor on each side (3 cards visible)

    const setOverlay = (role, company) => {
      if (!overlayTextEl) return;
      overlay?.classList.remove('is-form');
      overlay?.classList.add('is-deck-right');
      spTitle && (spTitle.textContent = '{{ _("Apply to jobs with one click") }}');
      overlayTextEl.textContent = `${role} — ${company}`;
      overlayTextEl.classList.add('is-visible');
    };

    const allPosClasses = [
      'is-center',
      'is-left1','is-left2','is-left3','is-left4','is-left5',
      'is-right1','is-right2','is-right3','is-right4','is-right5'
    ];

    const circDelta = (k, i, n) => {
      const fwd = (k - i + n) % n;
      const back = (i - k + n) % n;
      return (fwd <= back) ? fwd : -back;
    };

    const layout = () => {
      cards.forEach((c,k)=>{
        c.classList.remove(...allPosClasses, 'is-applied');
        c.style.opacity = 0;
        c.style.removeProperty('--ty');

        const d = circDelta(k, idx, N);
        if (d === 0) c.classList.add('is-center');
        else {
          const ad = Math.abs(d);
          if (ad <= MAX_NEI) c.classList.add(d < 0 ? `is-left${ad}` : `is-right${ad}`);
        }
      });
      allPosClasses.forEach(cls => {
        deck.querySelectorAll('.'+cls).forEach(el => el.style.opacity = '');
      });

      const role = cards[idx]?.querySelector('.card__role')?.textContent?.trim() || '';
      const company = cards[idx]?.querySelector('.card__company')?.textContent?.trim() || '';
      setOverlay(role, company);
    };

    const setActive = (i) => { idx = (i + N) % N; layout(); };

    const press = async (btn)=>{
      if (!btn) return;
      btn.classList.add('is-pressed');
      await pause(prefersReduced ? 120 : 240);
      btn.classList.remove('is-pressed');
    };

    const simulateApply = async (card) => {
      const btn = card.querySelector('.action--apply');
      await press(btn);
      card.classList.add('is-applied');
      await pause(prefersReduced ? 60 : 120);
      if (card.classList.contains('is-center')) card.style.setProperty('--ty','-8px');
      await pause(prefersReduced ? 400 : 900);
    };

    const runSequence = async ()=>{
      // ensure tinder visible exclusively
      section?.removeAttribute('hidden'); section?.removeAttribute('aria-hidden');
      const form = document.querySelector('.ai-demo');
      form?.setAttribute('hidden',''); form?.setAttribute('aria-hidden','true'); form && (form.style.display='none');

      for (let i=0; i<N; i++){
        setActive(i);
        await pause(prefersReduced ? 500 : 900);
        await simulateApply(cards[idx]);
      }

      await pause(prefersReduced ? 400 : 800);
      section?.setAttribute('hidden',''); section?.setAttribute('aria-hidden','true'); section && (section.style.display='none');
      form?.removeAttribute('hidden'); form?.removeAttribute('aria-hidden'); form && (form.style.display='');

      overlay?.classList.remove('is-deck-right');
      overlay?.classList.add('is-form');
      overlayTextEl && (overlayTextEl.textContent = '{{ _("AI applies for you") }}');

      window.AIDemo?.runOnce?.();
    };

    // Optional manual controls
    deck.addEventListener('click', async (e)=>{
      const active = cards[idx];
      if (!active) return;
      const applyBtn = e.target.closest('.action--apply');
      const dismissBtn = e.target.closest('.action--dismiss');
      if (applyBtn && active.contains(applyBtn)) {
        await simulateApply(active);
        setActive(idx + 1);
      } else if (dismissBtn && active.contains(dismissBtn)) {
        await pause(prefersReduced ? 300 : 600);
        setActive(idx + 1);
      }
    });

    // expose API
    window.TinderDemo = {
      show(){ section?.removeAttribute('hidden'); section?.removeAttribute('aria-hidden'); section && (section.style.display=''); setActive(0); },
      hide(){ section?.setAttribute('hidden',''); section?.setAttribute('aria-hidden','true'); section && (section.style.display='none'); },
      runOnce: runSequence
    };
  });
})();
</script>

<script>
/* =========================
   STEP 3B — AI Form controller (exposes window.AIDemo)
========================= */
(() => {
  const ready = (fn) => (document.readyState === 'loading'
    ? document.addEventListener('DOMContentLoaded', fn, { once:true })
    : fn());

  ready(() => {
    const root = document.querySelector('.ai-demo');
    if (!root) return;

    const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const pause = (ms) => new Promise(r => setTimeout(r, ms));

    const fields = {
      name:      root.querySelector('#ai-name'),
      email:     root.querySelector('#ai-email'),
      portfolio: root.querySelector('#ai-portfolio'),
      resume:    root.querySelector('#ai-resume'),
      cover:     root.querySelector('#ai-cover'),
      consent:   root.querySelector('#ai-consent'),
    };

    const resumeBtn  = root.querySelector('.ai-file__btn');
    const winEl      = root.querySelector('.ai-demo__window');
    const formEl     = root.querySelector('.ai-form');

    const progressBar = root.querySelector('.ai-demo__bar');
    const progressPct = root.querySelector('.ai-demo__pct');
    const statusText  = root.querySelector('#ai-status');
    const chip        = root.querySelector('#ai-chip');

    const setProgress = (v) => {
      const pct = Math.min(100, Math.max(0, Math.round(v)));
      if (progressBar) progressBar.style.setProperty('--pct', pct + '%');
      if (progressPct) progressPct.textContent = pct + '%';
    };

    const showChip = (ms = 2200) => { if (!chip) return; chip.classList.add('is-on'); setTimeout(()=>chip.classList.remove('is-on'), ms); };

    const typeInto = (el, text, speed = 22, onTick) => new Promise((resolve) => {
      if (prefersReduced) { el.value = text; onTick?.(text.length); resolve(); return; }
      let i = 0; el.value = '';
      const tick = () => {
        if (i > text.length) return resolve();
        el.value = text.slice(0, i);
        onTick?.(1);
        i++;
        setTimeout(tick, speed + Math.random() * 18);
      };
      tick();
    });

    const ensureSuccessUI = () => {
      let overlay = winEl.querySelector('.ai-success');
      if (!overlay) {
        winEl.insertAdjacentHTML('beforeend', `
          <div class="ai-success" hidden>
            <div class="ai-success__card" role="dialog" aria-modal="true" aria-label="{{ _('Application sent') }}">
              <div class="ai-success__icon" aria-hidden="true">
                <svg viewBox="0 0 52 52">
                  <circle class="ring" cx="26" cy="26" r="24"></circle>
                  <path class="mark" d="M16 27l7 7 13-13"></path>
                </svg>
              </div>
              <h4>{{ _('Application sent!') }}</h4>
              <p>{{ _('Your application was sent successfully.') }}</p>
              <button type="button" class="btn btn--primary ai-success__ok">{{ _('Nice!') }}</button>
            </div>
          </div>
        `);
        overlay = winEl.querySelector('.ai-success');
      }
      return { overlay, ok: overlay.querySelector('.ai-success__ok') };
    };
    const success = ensureSuccessUI();

    const RESUME_WEIGHT = prefersReduced ? 1 : 60;
    const steps = [
      { el: fields.name,      text: 'Ava Jensen' },
      { el: fields.email,     text: 'ava.jensen@uni.dk' },
      { el: fields.portfolio, text: 'https://ava.work' },
      { el: fields.resume,    upload: true, focusEl: resumeBtn },
      { el: fields.cover,     text: "{{ 'I’m excited to apply for the Investment Banking Intern role. At CBS Finance Club, I led a 4-member team on DCF/LBO case prep and placed top 3 in a regional valuation challenge. I’m comfortable with Excel, PowerPoint, and Bloomberg, and I’m eager to contribute from day one.'|escapejs }}" },
      { el: fields.consent,   check: true }
    ];

    const showSuccess = () => {
      winEl.classList.add('is-success');
      formEl.classList.add('is-success');
      success.overlay.removeAttribute('hidden');
      success.overlay.classList.add('is-visible');
      success.ok?.focus();
    };
    const hideSuccess = () => {
      success.overlay.classList.remove('is-visible');
      success.overlay.setAttribute('hidden','');
      winEl.classList.remove('is-success');
      formEl.classList.remove('is-success');
    };
    const fadeOutAndHide = async (delay = 1100) => {
      if (prefersReduced) { root.setAttribute('hidden',''); root.setAttribute('aria-hidden','true'); root.style.display='none'; return; }
      await pause(delay);
      winEl.classList.add('is-fading');
      await new Promise(res => winEl.addEventListener('transitionend', res, { once:true }));
      root.setAttribute('hidden',''); root.setAttribute('aria-hidden','true'); root.style.display='none';
      winEl.classList.remove('is-fading');
    };
    const autoPressAndCelebrate = async () => {
      statusText.textContent = "{{ _('Submitting…') }}";
      await pause(prefersReduced ? 120 : 600);
      showSuccess();
      await fadeOutAndHide(prefersReduced ? 0 : 1100);
    };

    let isRunning = false;
    const run = async () => {
      if (isRunning) return;
      isRunning = true;

      hideSuccess();
      root.removeAttribute('hidden'); root.removeAttribute('aria-hidden'); root.style.display='';

      statusText.textContent = "{{ _('AI is preparing your application…') }}";
      showChip();

      Object.values(fields).forEach((el) => {
        if (!el) return;
        if (el.type === 'checkbox') el.checked = false;
        else el.value = '';
        el.closest('.ai-field')?.classList.remove('is-active','is-done');
      });
      const resumeName = root.querySelector('.ai-file__name');
      const uploadWrap = root.querySelector('.ai-upload');
      const uploadBar  = root.querySelector('.ai-upload__bar');
      resumeName && (resumeName.textContent = resumeName.getAttribute('data-empty') || '');
      uploadWrap?.classList.remove('is-visible'); uploadBar?.style.setProperty('--up','0%');

      const totalChars = steps.reduce((n, s) => n + (s.text ? s.text.length : 0), 0) + RESUME_WEIGHT || 1;
      let typed = 0; setProgress(0);

      const focusField = (el) => {
        const wrap = el.closest('.ai-field');
        root.querySelectorAll('.ai-field').forEach(w => w.classList.remove('is-active'));
        wrap?.classList.add('is-active');
        wrap?.scrollIntoView?.({ block:'nearest', behavior: prefersReduced ? 'auto' : 'smooth' });
      };
      const checkField = (el) => el.closest('.ai-field')?.classList.add('is-done');

      const attachResume = async () => {
        statusText.textContent = "{{ _('AI is uploading your CV…') }}";
        const D = prefersReduced ? 40 : 1200; let used = 0;
        const btn = root.querySelector('.ai-file__btn');
        const upW = root.querySelector('.ai-upload');
        const upB = root.querySelector('.ai-upload__bar');
        btn?.classList.add('is-pressed'); await new Promise(r=>setTimeout(r,200)); btn?.classList.remove('is-pressed');
        upW?.classList.add('is-visible'); upB?.style.setProperty('--up','0%');
        await new Promise((resolve) => {
          const start = performance.now();
          const step = (now) => {
            const t = Math.min(1,(now-start)/D);
            upB?.style.setProperty('--up', Math.round(t*100)+'%');
            const add = Math.round(RESUME_WEIGHT * t) - used;
            if (add > 0){ used += add; typed += add; setProgress(typed/totalChars*100); }
            t<1 ? requestAnimationFrame(step) : resolve();
          }; requestAnimationFrame(step);
        });
        const nameEl = root.querySelector('.ai-file__name');
        if (nameEl) nameEl.textContent = 'Ava_Jensen_Resume.pdf';
        upW?.classList.remove('is-visible');
      };

      const pauseStep = prefersReduced ? 40 : 180;

      for (const s of steps) {
        if (!s.el) continue;
        focusField(s.focusEl || s.el);

        if (s.upload){ await attachResume(); checkField(s.el); await new Promise(r=>setTimeout(r,pauseStep)); continue; }
        if (s.check){ if (!prefersReduced) await new Promise(r=>setTimeout(r,300)); s.el.checked = true; if (!prefersReduced) await new Promise(r=>setTimeout(r,200)); checkField(s.el); continue; }

        const label = (s.el.labels?.[0]?.innerText || '').trim();
        statusText.textContent = `{{ _('AI is filling') }} “${label}”…`;
        await typeInto(s.el, s.text, 22, () => { typed += 1; setProgress(typed/totalChars*100); });
        checkField(s.el);
        await new Promise(r=>setTimeout(r,pauseStep));
      }

      setProgress(100);
      statusText.textContent = "{{ _('Ready to submit — optimized by AI.') }}";
      await autoPressAndCelebrate();
      isRunning = false;
      return true;
    };

    window.AIDemo = {
      runOnce: run,
      hide: () => { root.setAttribute('hidden',''); root.setAttribute('aria-hidden','true'); root.style.display='none'; },
      show: () => { root.removeAttribute('hidden'); root.removeAttribute('aria-hidden'); root.style.display=''; }
    };
  });
})();
</script>

<script>
/* =========================
   STEP 1 — "Upload your resume" controller (exposes window.ResumeDemo)
========================= */
(() => {
  const ready = (fn) => (document.readyState === 'loading'
    ? document.addEventListener('DOMContentLoaded', fn, { once:true })
    : fn());

  ready(() => {
    const container = document.getElementById('resumeStep');
    const root = document.getElementById('resumeDemo');
    if (!root || !container) return;

    const cursor   = root.querySelector('.rs-cursor');
    const fileCard = root.querySelector('.rs-file');
    const dz       = root.querySelector('.rs-dropzone');
    const progWrap = root.querySelector('.rs-progress');
    const progBar  = root.querySelector('.rs-progress__bar');
    const progPct  = root.querySelector('.rs-progress__pct');
    const done     = root.querySelector('.rs-done');
    const live     = root.querySelector('#rs-live');

    const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const rect = (el) => el.getBoundingClientRect();

    const moveTo = (el, x, y, dur = 600, ease = 'cubic-bezier(.22,.61,.36,1)') =>
      new Promise(res => {
        el.style.transition = `transform ${dur}ms ${ease}`;
        el.style.transform  = `translate3d(${x}px, ${y}px, 0)`;
        const done = () => { el.removeEventListener('transitionend', done); res(); };
        el.addEventListener('transitionend', done, { once:true });
        setTimeout(res, dur + 40);
      });

    const announce = (msg) => { if (live) live.textContent = msg; };

    const animateOnce = async () => {
      dz.classList.remove('is-over');
      fileCard.classList.remove('is-grabbed');
      progWrap.classList.remove('is-visible');
      done.classList.remove('is-visible');
      progBar.style.setProperty('--pct', '0%');
      progPct.textContent = '0%';
      fileCard.style.transition = 'none';
      fileCard.style.left = 'calc(50% - 720px)';
      fileCard.style.opacity = '1';
      fileCard.style.transform = 'translate(0, -50%)';

      const rRoot = rect(root);
      const rFile = rect(fileCard);
      const rDz   = rect(dz);

      const fcx = rFile.left - rRoot.left + rFile.width / 2;
      const fcy = rFile.top  - rRoot.top  + rFile.height / 2;
      const dzcx = rDz.left  - rRoot.left + rDz.width  / 2;
      const dzcy = rDz.top   - rRoot.top  + rDz.height / 2;

      const startX = fcx + 16;
      const startY = fcy + 10;
      cursor.style.transition = 'none';
      cursor.style.transform  = `translate3d(${startX}px, ${startY}px, 0)`;

      if (prefersReduced){
        announce('{{ _("First you upload your resume") }}');
        fileCard.classList.add('is-grabbed');
        dz.classList.add('is-over');
        progWrap.classList.add('is-visible');
        let pct = 0;
        await new Promise((resolve) => {
          const t = setInterval(() => {
            pct += 10;
            if (pct >= 100){ pct = 100; clearInterval(t); progWrap.classList.remove('is-visible'); done.classList.add('is-visible'); resolve(); }
            progBar.style.setProperty('--pct', pct + '%');
            progPct.textContent = pct + '%';
          }, 70);
        });
        return;
      }

      await moveTo(cursor, startX, startY, 380);
      announce('{{ _("First you upload your resume") }}');
      fileCard.classList.add('is-grabbed');

      dz.classList.add('is-over');
      const dx = dzcx - fcx;
      const dy = dzcy - fcy;
      const duration = 900;

      cursor.style.transition = `transform ${duration}ms cubic-bezier(.22,.61,.36,1)`;
      fileCard.style.transition = `transform ${duration}ms cubic-bezier(.22,.61,.36,1)`;
      cursor.style.transform = `translate3d(${dzcx}px, ${dzcy}px, 0)`;
      fileCard.style.transform = `translate(${dx - 20}px, calc(-50% + ${dy - 10}px))`;

      await new Promise(r => setTimeout(r, duration + 40));
      fileCard.style.transition = 'opacity .25s ease';
      fileCard.style.opacity = '0';

      progWrap.classList.add('is-visible');
      announce('{{ _("Uploading resume…") }}');
      let pct = 0;
      await new Promise((resolve) => {
        const timer = setInterval(() => {
          pct += 6 + Math.random()*8;
          if (pct >= 100){ pct = 100; clearInterval(timer); resolve(); }
          progBar.style.setProperty('--pct', Math.round(pct) + '%');
          progPct.textContent = Math.round(pct) + '%';
        }, 80);
      });

      progWrap.classList.remove('is-visible');
      done.classList.add('is-visible');
      announce('{{ _("Uploaded successfully") }}');
        // ✅ Leave final state visible (no reset)
        await new Promise(r => setTimeout(r, 900));
        // Keep "Uploaded" card + 100% visible until orchestrator hides step
        // (comment out reset)
        dz.classList.remove('is-over');
        fileCard.classList.remove('is-grabbed');
        // fileCard.style.opacity = '';
        // fileCard.style.transition = 'none';
        // fileCard.style.transform  = 'translate(0, -50%)';
    };

    window.ResumeDemo = {
      show(){ container.removeAttribute('hidden'); container.removeAttribute('aria-hidden'); container.style.display=''; },
      hide(){ container.setAttribute('hidden',''); container.setAttribute('aria-hidden','true'); container.style.display='none'; },
      runOnce: animateOnce
    };
  });
})();
</script>

<script>
/* =========================
   STEP 2 — AI Analysis controller (exposes window.RADemo)
========================= */
(() => {
  const ready = (fn) => (document.readyState === 'loading'
    ? document.addEventListener('DOMContentLoaded', fn, { once:true })
    : fn());

  ready(() => {
    const container = document.getElementById('analysisStep');
    const root = document.getElementById('raDemo');
    if (!root || !container) return;

    const panel   = root.querySelector('.ra-list');
    const progBar = root.querySelector('.ra-progress__bar');
    const progPct = root.querySelector('.ra-progress__pct');
    const status  = root.querySelector('.ra-status');

    const pause = (ms) => new Promise(r => setTimeout(r, ms));
    const setProgress = (v) => {
      const p = Math.max(0, Math.min(100, Math.round(v)));
      progBar.style.setProperty('--pct', p + '%');
      progPct.textContent = p + '%';
    };




    const addFinding = (k, v) => {
      const li = document.createElement('li');
      li.className = 'ra-item';
      li.innerHTML = `<div class="ra-k">${k}</div>
                      <div class="ra-v">${v}</div>
                      <div class="ra-ok">✓</div>`;
      panel.appendChild(li);
      requestAnimationFrame(() => li.classList.add('is-in'));
    };

    const highlight = async (el, say) => {
      status.textContent = say;
      const isInline = getComputedStyle(el).display === 'inline';
      if (isInline) el.classList.add('is-inline');
      el.classList.add('ra-focus','is-on');
      await pause(900);
      el.classList.remove('is-on');
      if (isInline) el.classList.remove('is-inline');
      await pause(150);
    };

    const runOnce = async () => {
      status.textContent = '{{ _("Scanning document…") }}';
      setProgress(0);
      panel.innerHTML = '';

      for (let i = 0; i < steps.length; i++) {
        const s = steps[i];
        const el = root.querySelector(s.sel);
        if (!el) continue;
        await highlight(el, s.say);
        addFinding(s.key, s.value);
        setProgress(((i+1)/steps.length) * 100);
        await pause(320);
      }
      status.textContent = '{{ _("Analysis complete") }}';
    };

    window.RADemo = {
      show(){ container.removeAttribute('hidden'); container.removeAttribute('aria-hidden'); container.style.display=''; },
      hide(){ container.setAttribute('hidden',''); container.setAttribute('aria-hidden','true'); container.style.display='none'; },
      runOnce
    };
  });
})();
</script>

<script>
    /* =========================
       MASTER ORCHESTRATOR — runs the three steps in strict sequence (no overlap)
       (✱ Added pauses between each step)
    ========================= */
    (() => {
      const ready = (fn) => (document.readyState === 'loading'
        ? document.addEventListener('DOMContentLoaded', fn, { once:true })
        : fn());
    
      ready(async () => {
        const stage   = document.querySelector('.demo-stage');
        const overlay = document.querySelector('.demo-overlay');
        const overlayText = document.querySelector('.demo-overlay__text');
        const spTitle = document.getElementById('spTitle');
    
        const pause = (ms) => new Promise(res => setTimeout(res, ms));
    
        const setVisible = (el, show) => {
          if (!el) return;
          if (show) { el.removeAttribute('hidden'); el.removeAttribute('aria-hidden'); el.style.display=''; }
          else { el.setAttribute('hidden',''); el.setAttribute('aria-hidden','true'); el.style.display='none'; }
        };
    
        const resumeEl  = document.getElementById('resumeStep');
        const analysisEl = document.getElementById('analysisStep');
        const tinderEl  = document.querySelector('.tinder-section');
        const formEl    = document.querySelector('.ai-demo');
    
        const exclusive = (name) => {
          setVisible(resumeEl,  name === 'resume');
          setVisible(analysisEl,name === 'analysis');
          setVisible(tinderEl,  name === 'tinder');
          setVisible(formEl,    name === 'form');
        };
    
        const showOverlayTop = (text) => {
          overlay?.classList.remove('is-deck-right');
          overlay?.classList.add('is-form');
          if (overlayText){ overlayText.textContent = text; overlayText.classList.add('is-visible'); }
        };
        const showOverlayDeck = (text) => {
          overlay?.classList.remove('is-form');
          overlay?.classList.add('is-deck-right');
          if (overlayText){ overlayText.textContent = text; overlayText.classList.add('is-visible'); }
        };
    
        const waitVisible = () => new Promise(res=>{
          if (!('IntersectionObserver' in window)) return res();
          const io = new IntersectionObserver((entries)=>{
            if (entries.some(e => e.isIntersecting)) { io.disconnect(); res(); }
          }, { threshold: 0.3 });
          stage ? io.observe(stage) : res();
        });
    
        exclusive(null);
        await waitVisible();
    
        /* ========== STEP 1: Upload Resume ========== */
        spTitle && (spTitle.textContent = '{{ _("Upload your resume") }}');
   
        exclusive('resume');
        await window.ResumeDemo?.runOnce?.();
    
        // ⏳ Add a short pause before showing analysis
        await pause(1200); // 1.2 seconds
        exclusive(null);
    
        /* ========== STEP 2: AI Analyzes ========== */
        spTitle && (spTitle.textContent = '{{ _("AI analyzes your resume") }}');
        exclusive('analysis');
        await window.RADemo?.runOnce?.();
    
        // ⏳ Add a pause before moving to Tinder animation
        await pause(1500); // 1.5 seconds
        exclusive(null);
    
        /* ========== STEP 3: Tinder Deck + AI Form ========== */
        spTitle && (spTitle.textContent = '{{ _("Do like everyone else — apply with AI") }}');
        showOverlayDeck('{{ _("Swipe right to apply") }}');
        exclusive('tinder');
        await window.TinderDemo?.runOnce?.(); // triggers AI form next automatically
      });
    })();
    </script>
    
